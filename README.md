# Лабораторная работа 2 DHCP клиент

## Инструкция по использованию:
Программа написана на языке Java.
1. Скомпилировать программу: `javac dhcp_client.java`.
2. Запустить программу: `java dhcp_client`.

### Пример использования программы:
```
D:\Projects\Java\DHCP_new\DHCP_Client>java dhcp_client
Send Discover Packet
Received a response
Response is Offer
Ip: 192.168.1.2
Send Request
Received a response
Response is Pack
Ip: 192.168.1.2
```
## Описание протокола

DHCP - сетевой протокол, позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры, 
необходимые для работы в сети TCP/IP. Данный протокол работает по модели «клиент-сервер». Для автоматической 
конфигурации компьютер-клиент на этапе конфигурации сетевого устройства обращается к так называемому серверу
 DHCP и получает от него нужные параметры. Сетевой администратор может задать диапазон адресов, распределяемых 
 сервером среди компьютеров. Это позволяет избежать ручной настройки компьютеров сети и уменьшает количество
 ошибок. Протокол DHCP используется в большинстве сетей TCP/IP. Передача данных производится при помощи 
 протокола UDP. По умолчанию запросы от клиента делаются на 67 порт к серверу, сервер в свою очередь отвечает 
 на порт 68 к клиенту, выдавая адрес IP и другую необходимую информацию, такую, как сетевую маску,
 маршрутизатор и серверы DNS.
### Структура сообщений DHCP
### Общий принцип работы DHCP:
* Клиент рассылает широковещательный UDP запрос (DHCPDISCOVER) по всей сети с запросом 
получить IP-адрес. По умолчанию запросы от клиента делаются на 67 порт к серверу, сервер в свою очередь отвечает 
              на порт 68 к клиенту.Внутри пакета DHCPDISCOVER
               включен MAC адрес устройства клиента.
* Все сервера DHCP, находящиеся в сети (а их может быть несколько), формируют для устройства, отправившего DHCPDISCOVER, предложение DHCPOFFER с сетевыми настройками, и также широковещательно его отсылает его по сети. Идентификация кому предназначен этот пакет идет по MAC адресу клиента, предоставленного ранее в запросе DHCPDISCOVER.
* Клиент принимает пакеты с предложениями сетевых настроек, выбирает наиболее привлекательный (критерии могут быть различными, например, в т.ч. и по времени доставки пакета, количестве промежуточных маршрутов), и делает у понравившегося сервера DHCP «официальный запрос» DHCPREQUEST с сетевыми настройками. В этом случае пакет идет уже к конкретному серверу DHCP.
* Сервер, получивший DHCPREQUEST, отправляет пакет формата DHCPACK, в котором в очередной раз перечисляет сетевые настройки, предназначенные для данного клиента

## Реализация 
Программа реалиазована на языке Java. Используются `DatagramSocket` - сокеты для отправки и получения `DatagramPacket`, 
в которых хранятся данные с запросами. `DHCP_Message.java` представляет собой стандартное сообщение DHCP со всеми полями,
которые используются в DHCP протоколе. Также с помощью этого класса можно создать нужное сообщение (DISCOVER, REQUEST),
для отправки в сокет. В классе `DhcpMessageHelper` есть вспомогательная функция для определения сообщения от сервера
(OFFER, PACK). Вся работа клиента происходит в `DhcpRunner.java`. Сначало посылается широковещательное сообщение 
DISCOVER, затем слушется сокет, на ответ от сервера. Когда приходит ответ от сервера, определяется, что это за ответ: 
если это OFFER, то серверу отправляется REQUEST на подтверждение выданного ip адреса. Если это подтверждение 
ip адреса (PACK) то выданный ip адрес "принимается" и программа завершает свою работу.
### Тестирование 
Тестирование проводилось на локальной машине с использованием стандартных реализаций DHCP сервера и реализации DHCP сервера на Java.